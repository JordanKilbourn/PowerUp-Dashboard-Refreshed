<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Playworld PowerUp — Splash</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
:root{
  --accent: #00ffc6;
  --dashboard-bg: #0e1415;

  /* Montage pacing */
  --shot-hold: 140ms;
  --shot-xfade: 100ms;
  --kenburns-scale: 1.06;
  --kenburns-pan-x: 10px;
  --kenburns-pan-y: 8px;
  --tilt-deg: 4deg;

  /* Title timing (JS sets --montage-duration & --sweep-delay) */
  --montage-duration: 6000ms;
  --wordmark-delay: 60ms;
  --wordmark-arrive-frac: 0.95;

  /* Sweep */
  --sweep-delay: 2400ms;     /* set in JS near montage end */
  --sweep-duration: 2600ms;
  --stroke-offset: 140ms;    /* <<< repaint starts AFTER sweep begins */

  /* Final resolve */
  --final-hold: 1400ms;
  --brand-hold: 1200ms;      /* extra beat after recolor */

  /* Outline thickness knob */
  --stroke-width: 2px;       /* thinner border */
}

html,body{height:100%;margin:0;background:var(--dashboard-bg);color:#fff}
*{box-sizing:border-box}

.splash{
  position:fixed; inset:0; z-index:9999;
  background:#000; overflow:hidden; display:none;
  opacity:1; transition:opacity 540ms ease-in;
}
.splash.fade-out{ opacity:0; pointer-events:none }

/* Layering: montage < lens < vignette < lockup */
.montage{ position:absolute; inset:0; overflow:hidden; isolation:isolate; opacity:1; z-index:0 }
.shot{
  position:absolute; inset:0;
  background-size:cover; background-position:center;
  opacity:0; transform:scale(1) translate3d(0,0,0);
  will-change: opacity, transform;
}
@keyframes shotLife{
  0%   { opacity:0; transform:scale(1) rotate(0deg) translate3d(0,0,0) }
  12%  { opacity:1 }
  82%  { opacity:1; transform:scale(var(--kenburns-scale)) rotate(var(--tilt-deg))
                    translate3d(var(--kenburns-pan-x),var(--kenburns-pan-y),0) }
  100% { opacity:0; transform:scale(var(--kenburns-scale)) rotate(var(--tilt-deg))
                    translate3d(var(--kenburns-pan-x),var(--kenburns-pan-y),0) }
}

.lens{
  position:absolute; inset:0; pointer-events:none; opacity:1; z-index:1;
  background:
    radial-gradient(120% 120% at 50% 50%, rgba(255,0,0,0.18), rgba(255,0,0,0.38)),
    linear-gradient(to bottom, rgba(180,0,0,0.32), rgba(80,0,0,0.26));
  mix-blend-mode:multiply;
  filter:saturate(1.4) contrast(1.18);
}

.cardwash{ position:absolute; inset:0; pointer-events:none; opacity:0; background: var(--dashboard-bg); z-index:0 }
.cardwash.parallax{
  animation: finalParallax var(--brand-hold) ease-out forwards;
}
@keyframes finalParallax{
  0%   { transform: scale(1) translateY(0) }
  100% { transform: scale(1.012) translateY(-2px) }
}

.vignette{
  pointer-events:none; position:absolute; inset:0; z-index:2;
  background:
    radial-gradient(ellipse at center, rgba(0,0,0,0) 48%, rgba(0,0,0,.55) 100%),
    linear-gradient(to top, rgba(0,0,0,.20), rgba(0,0,0,0) 30% 70%, rgba(0,0,0,.26));
  mix-blend-mode:multiply;
}

.lockup{ position:absolute; inset:0; display:grid; place-items:center; pointer-events:none; z-index:3 }
.wordmark-wrap{
  display:flex; flex-direction:column; align-items:center; gap:.6rem;
  transform:translateZ(0) scale(3.0);
  opacity:0;
  animation: titleArrive calc(var(--montage-duration) * var(--wordmark-arrive-frac)) ease-out forwards;
  animation-delay: var(--wordmark-delay);
}
@keyframes titleArrive{
  0%   { transform:scale(3.0); opacity:0 }
  35%  { opacity:.50 }
  75%  { opacity:.92 }
  100% { transform:scale(1.02); opacity:1 }
}

/* === Wordmark stack: white fill + accent outline reveal + sweep + sparks === */
.wordmark{
  position:relative; line-height:1;
  font-family: Impact, Haettenschweiler,'Arial Narrow Bold','Bebas Neue',sans-serif;
  font-weight:900; text-transform:uppercase;
  font-size: clamp(52px, 14vw, 184px);
  letter-spacing:.06em;
}
.wordmark-fill{
  position:relative; z-index:0; display:inline-block;
  color:#fff; mix-blend-mode:normal; filter:none;
  text-shadow: 0 4px 10px rgba(0,0,0,.35);
}

/* Accent outline: reveals L→R just BEHIND the sweep, then persists (outline ONLY) */
.wordmark-stroke{
  position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
  color: transparent;                     /* no fill */
  -webkit-text-fill-color: transparent;   /* ensure no interior fill on webkit */
  -webkit-text-stroke: var(--stroke-width) var(--accent);
  paint-order: stroke fill;
  z-index:1; pointer-events:none;

  /* Reveal from left → right using clip-path */
  clip-path: inset(0 100% 0 0); /* fully hidden (right = 100%) */
  animation: strokeFillLTR var(--sweep-duration) ease-in-out forwards;
  /* start after the sweep starts */
  animation-delay: calc(var(--sweep-delay) + var(--stroke-offset));
}
.wordmark-stroke.full{ clip-path: inset(0 0 0 0); }
/* one-time, subtle glow settle after the outline locks */
.wordmark-stroke.glow{ animation: outlineGlow 800ms ease-out 1 both; }

@keyframes strokeFillLTR{
  from { clip-path: inset(0 100% 0 0); }
  to   { clip-path: inset(0 0    0 0); }
}
@keyframes outlineGlow{
  0%   { filter: drop-shadow(0 0 0 rgba(0,255,198,0.0)); }
  40%  { filter: drop-shadow(0 0 14px rgba(0,255,198,0.65)); }
  100% { filter: drop-shadow(0 0 6px  rgba(0,255,198,0.25)); }
}

/* Silver sweep visual */
.sweep{
  position:absolute; inset:0; overflow:hidden; pointer-events:none; z-index:2;
  -webkit-mask-image: linear-gradient(to right, transparent 0, black 22%, black 78%, transparent 100%);
          mask-image: linear-gradient(to right, transparent 0, black 22%, black 78%, transparent 100%);
}
.sweep::before{
  content:""; position:absolute; top:-46%; left:-90%;
  width:58%; height:230%;
  transform:rotate(18deg);
  background:linear-gradient(to right, rgba(255,255,255,0) 0%, rgba(255,255,255,1) 50%, rgba(255,255,255,0) 100%);
  filter:blur(4px); opacity:0;
  animation:sweep var(--sweep-duration) ease-in-out forwards;
  animation-delay: var(--sweep-delay);
}
@keyframes sweep{
  0%   { transform:translateX(0) rotate(18deg);   opacity:0 }
  15%  { opacity:1 }
  85%  { opacity:.98 }
  100% { transform:translateX(320%) rotate(18deg); opacity:0 }
}

/* Accent sparks riding the sweep edge (subtle) */
.sparks{ position:absolute; inset:0; pointer-events:none; z-index:2 }
.spark{
  position:absolute; width:10px; height:10px; border-radius:50%;
  background: radial-gradient(circle, rgba(0,255,198,1) 0%, rgba(0,255,198,0.3) 60%, rgba(0,255,198,0) 70%);
  filter: blur(0.5px) brightness(1.1);
  opacity:0;
  transform: translateX(-60%);
  animation: sparkTravel var(--sweep-duration) ease-in-out forwards;
  animation-delay: calc(var(--sweep-delay) + var(--stroke-offset));
}
.spark::after{ /* tiny tail */
  content:""; position:absolute; left:-14px; top:4px; width:22px; height:2px; border-radius:2px;
  background: linear-gradient(90deg, rgba(0,255,198,0), rgba(0,255,198,.6), rgba(0,255,198,0));
  filter: blur(0.6px);
}

/* place sparks at slightly different bands across the wordmark height */
.spark.s1{ top:18% }
.spark.s2{ top:45% }
.spark.s3{ top:62% }
.spark.s4{ top:30% }

@keyframes sparkTravel{
  0%   { transform: translateX(-60%); opacity:0 }
  8%   { opacity:1 }
  18%  { opacity:.0 }
  100% { transform: translateX(240%); opacity:0 }
}

/* Divider — hidden by default; revealed & sized in JS after PowerUp appears */
.divider{
  height:3px; width:0;
  background: linear-gradient(90deg, transparent 0, var(--accent) 20%, var(--accent) 80%, transparent 100%);
  opacity:0; border-radius:2px;
  align-self:center;
  transition: width 420ms ease, opacity 240ms ease;
}
.divider.show{ opacity:.95 }

/* PowerUp — big + punch-in */
.subbar{
  font-family:'Segoe UI', Arial, sans-serif;
  font-weight:900;
  letter-spacing:.22em;
  color: var(--accent);
  font-size: clamp(22px, 3.8vw, 52px);
  text-shadow: 0 0 10px rgba(0,255,198,0.10);
  opacity:0;
  transform: translateY(10px) scale(0.94);
  animation: subbarPunch 900ms cubic-bezier(.2,.9,.2,1) forwards;
}
@keyframes subbarPunch{
  0%   { opacity:0; transform: translateY(10px) scale(0.94) }
  55%  { opacity:1; transform: translateY(0)    scale(1.14) }
  100% { opacity:1; transform: translateY(0)    scale(1.00) }
}

@keyframes montageFadeOut { 0%{opacity:1} 92%{opacity:1} 100%{opacity:0} }
@keyframes cardwashFadeIn { 0%{opacity:0} 60%{opacity:.25} 100%{opacity:1} }

.final{
  position:absolute; inset:0; background: var(--dashboard-bg);
  opacity:0; pointer-events:none; transition:opacity 420ms ease-in;
}
.final.show{ opacity:1 }

.skip{
  position:absolute; right:16px; bottom:16px; z-index:4;
  background: rgba(0,0,0,.45); color:#fff;
  padding:.55rem .8rem; border-radius:999px; border:1px solid rgba(255,255,255,.25);
  font: 500 .9rem/1 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  cursor:pointer; user-select:none; transition: background .2s ease;
}
.skip:hover{ background: rgba(0,0,0,.65) }

@media (prefers-reduced-motion: reduce){
  .shot, .wordmark-wrap, .sweep::before, .subbar, .wordmark-stroke, .spark{
    animation: none !important; opacity:1 !important; transform:none !important
  }
  .wordmark-stroke{ clip-path: none !important }
}
</style>
</head>
<body>

<div id="splash" class="splash" aria-hidden="true">
  <div class="montage" id="montage"></div>
  <div class="lens" aria-hidden="true"></div>
  <div class="cardwash" aria-hidden="true"></div>
  <div class="vignette" aria-hidden="true"></div>

  <div class="lockup" aria-hidden="true">
    <div class="wordmark-wrap">
      <div class="wordmark" aria-label="PLAYWORLD">
        <span class="wordmark-fill">PLAYWORLD</span>
        <span class="wordmark-stroke" aria-hidden="true">PLAYWORLD</span>
        <div class="sweep" aria-hidden="true"></div>
        <div class="sparks" aria-hidden="true">
          <span class="spark s1"></span>
          <span class="spark s2"></span>
          <span class="spark s3"></span>
          <span class="spark s4"></span>
        </div>
      </div>
      <div class="divider" aria-hidden="true"></div>
      <div class="subbar">PowerUp</div>
    </div>
  </div>

  <div id="finalCard" class="final" aria-hidden="true"></div>

  <button id="skipBtn" class="skip" type="button" aria-label="Skip Intro">
    Skip Intro
  </button>
</div>

<script>
/* === Curated Playworld set === */
const IMAGE_SETS = [
  { name:'playworld', base:'', files: [
    "https://playworld.com/wp-content/uploads/2024/07/ClarkV_240612__U7A0416-scaled.jpg",
    "https://playworld.com/wp-content/uploads/2024/07/ClarkV_240612__U7A9136-scaled.jpg",
    "https://playworld.com/wp-content/uploads/2023/09/tz-2325-web-image-2.png",
    "https://playworld.com/wp-content/uploads/2025/01/rs-2370-web-image-1.png",
    "https://playworld.com/wp-content/uploads/2023/09/rs-2315-web-image-1.png",
    "https://playworld.com/wp-content/uploads/2023/09/zzxx1123-web-image-1-scaled.jpg",
    "https://playworld.com/wp-content/uploads/2023/09/zzun8771-web-image-2.jpg",
    "https://playworld.com/wp-content/uploads/2023/09/500-2039-web-image-1.png",
    "https://secure.viewer.zmags.com/services/resource/pub/4aa2a8e9/pg683x856/5/6?viewerID=cdc7b5af",
    "https://secure.viewer.zmags.com/services/resource/pub/4aa2a8e9/pg683x856/5/26?viewerID=cdc7b5af",
    "https://playworld.com/wp-content/uploads/2023/10/LOC-Pirate-Ship-NJ-020_QCC-BackgroundEditforText.jpg",
    "https://playworld.com/wp-content/uploads/2025/02/PW_2025_Smith-Ranch-Eagle-Mountain-UT_241023__0011741_Edit_SM.jpg",
    "https://playworld.com/wp-content/uploads/2024/01/PW_2024_Piney-Orchard_Edit_10-940x627.jpeg",
    "https://playworld.com/wp-content/uploads/2024/07/ClarkV_240612__U7A9125-2048x1366.jpg",
    "https://playworld.com/wp-content/uploads/2023/10/PW_Rope-Web-Images_09-min-2048x1365.jpg",
    "https://playworld.com/wp-content/uploads/2024/01/PW_2024_RopeScapes_Lewisburg-PA_42-copy.jpg",
    "https://playworld.com/wp-content/uploads/2023/10/Cleveland_Elementary_Washington_D.C_201002__96A9723-min-2048x1365.jpg",
    "https://playworld.com/wp-content/uploads/2025/09/PW_2026_Cook-Family-Park_Pleasant-Grove-UT_250811__0013651.jpg",
    "https://playworld.com/wp-content/uploads/2023/10/PlayTown_Playhouse_02-2048x1152.jpg"
  ]}
];

const SHOTS_PER_RUN = 22;
const SHUFFLE_WITHIN_SET = true;
const STORAGE_KEY = 'pw_splash_set_index';

const elSplash  = document.getElementById('splash');
const elMontage = document.getElementById('montage');
const elFinal   = document.getElementById('finalCard');
const elLens    = document.querySelector('.lens');
const elCard    = document.querySelector('.cardwash');
const elDivider = document.querySelector('.divider');
const elSubbar  = document.querySelector('.subbar');
const btnSkip   = document.getElementById('skipBtn');

const shotHold  = cssMs('--shot-hold', 140);
const xfade     = cssMs('--shot-xfade', 100);
const step      = shotHold + xfade;

const kenScale  = getCss('--kenburns-scale', 1.06);
const panX      = getCss('--kenburns-pan-x', '10px');
const panY      = getCss('--kenburns-pan-y', '8px');

const finalHold = cssMs('--final-hold', 1400);
const brandHold = cssMs('--brand-hold', 1200);   // extra pause after recolor

let timers = [];
function clearTimers(){ timers.forEach(t=>clearTimeout(t)); timers=[]; }

btnSkip.addEventListener('click', skipAll, {passive:true});
window.Splash = { play: startSequence, skip: skipAll };

startSequence();

async function startSequence(){
  if(!IMAGE_SETS.length) return;

  const idx = getNextSetIndex();
  const set = IMAGE_SETS[idx];
  let urls = set.files.map(f => set.base + f);

  if(SHUFFLE_WITHIN_SET) urls = shuffle(urls);
  if(urls.length > SHOTS_PER_RUN) urls = urls.slice(0, SHOTS_PER_RUN);

  elSplash.style.display = 'block';
  document.documentElement.style.overflow = 'hidden';

  await preloadBounded(urls.slice(0,2), 2);
  buildShots(urls);
  preloadBounded(urls.slice(2), 6);

  const montageDuration = urls.length * step;
  document.documentElement.style.setProperty('--montage-duration', montageDuration + 'ms');

  elMontage.style.animation = `montageFadeOut ${montageDuration}ms linear forwards`;
  elLens.style.animation    = `montageFadeOut ${montageDuration}ms linear forwards`;
  elCard.style.animation    = `cardwashFadeIn ${montageDuration}ms linear forwards`;

  /* Sweep very late so it doesn't fight montage */
  const sweepDelay = Math.max(0, Math.round(montageDuration - 350));
  document.documentElement.style.setProperty('--sweep-delay', sweepDelay + 'ms');

  /* PowerUp timing: start a beat after the sweep kicks in */
  const SUBBAR_DELAY_OFFSET = 180; // ms after sweep begins
  elSubbar.style.animationDelay = (sweepDelay + SUBBAR_DELAY_OFFSET) + 'ms';

  /* Reveal & center divider exactly when PowerUp animates */
  const showDividerAt = sweepDelay + SUBBAR_DELAY_OFFSET + 90;
  timers.push(setTimeout(() => {
    syncDividerWidth();
    elDivider.classList.add('show');
    observeSubbar();
  }, showDividerAt));

  /* Keep the outline permanently after the stroke reveal finishes + quick glow settle */
  const elStroke = document.querySelector('.wordmark-stroke');
  const sweepDur = cssMs('--sweep-duration', 2600);
  const strokeOffset = cssMs('--stroke-offset', 140);
  timers.push(setTimeout(() => {
    if (!elStroke) return;
    elStroke.classList.add('full');
    elStroke.classList.add('glow');
    setTimeout(()=> elStroke.classList.remove('glow'), 900);
  }, sweepDelay + strokeOffset + sweepDur + 20)); // wait for stroke animation to complete

  /* Final resolve timings — add extra brandHold before fade */
  const showFinalAt = Math.max(0, montageDuration - 120);
  const endAt       = montageDuration + finalHold + brandHold;

  // Micro parallax on the flat card during the final hold
  timers.push(setTimeout(()=> {
    elFinal.classList.add('show');
    elCard.classList.add('parallax');
  }, showFinalAt));

  timers.push(setTimeout(endSequence, endAt));
}

function endSequence(){
  elSplash.classList.add('fade-out');
  setTimeout(()=>{
    elFinal.classList.remove('show');
    elCard.classList.remove('parallax');
    elSplash.style.display = 'none';
    elSplash.classList.remove('fade-out');
    document.documentElement.style.overflow = '';
    clearTimers();
    if (ro) { ro.disconnect(); ro = null; }
  }, 540);
}

function skipAll(){
  clearTimers();
  elFinal.classList.add('show');
  elCard.classList.add('parallax');
  setTimeout(endSequence, 320);
}

function buildShots(images){
  elMontage.innerHTML = '';
  images.forEach((src, i)=>{
    const d = document.createElement('div');
    d.className = 'shot';
    d.style.backgroundImage = `url("${src}")`;
    d.style.setProperty('--kenburns-scale', kenScale);
    d.style.setProperty('--kenburns-pan-x', panX);
    d.style.setProperty('--kenburns-pan-y', panY);
    d.style.setProperty('--tilt-deg', '4deg');

    const animLen = step + 200;
    const delay   = i * step;
    d.style.animation = `shotLife ${animLen}ms ${delay}ms both ease-in-out`;
    elMontage.appendChild(d);
  });
}

/* ===== Divider sizing tied to PowerUp width ===== */
function syncDividerWidth(){
  const w = elSubbar.getBoundingClientRect().width;
  elDivider.style.width = Math.max(0, Math.round(w)) + 'px';
}
let ro = null;
function observeSubbar(){
  if (ro) return;
  ro = new ResizeObserver(() => syncDividerWidth());
  ro.observe(elSubbar);
}

/* ===== Helpers ===== */
function cssMs(varName, fallback){
  const v = getComputedStyle(document.documentElement).getPropertyValue(varName).trim();
  if(!v) return fallback;
  if(v.endsWith('ms')) return parseFloat(v);
  if(v.endsWith('s'))  return parseFloat(v)*1000;
  const n = parseFloat(v); return Number.isFinite(n) ? n : fallback;
}
function getCss(varName, fallback){
  const v = getComputedStyle(document.documentElement).getPropertyValue(varName).trim();
  return v || fallback;
}
function shuffle(arr){
  for(let i=arr.length-1;i>0;i--){
    const j = (Math.random()*(i+1))|0;
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
  return arr;
}
function preloadBounded(urls, concurrency=6){
  if(!urls || !urls.length) return Promise.resolve();
  let i=0, inflight=0;
  return new Promise(resolve=>{
    const pump=()=>{
      if(i>=urls.length && inflight===0) return resolve();
      while(inflight<concurrency && i<urls.length){
        const img=new Image();
        img.decoding='async'; img.loading='eager';
        img.src=urls[i++]; inflight++;
        img.onload=img.onerror=()=>{ inflight--; pump(); };
      }
    };
    pump();
  });
}
function getNextSetIndex(){
  const max = IMAGE_SETS.length;
  const raw = localStorage.getItem(STORAGE_KEY);
  let idx = parseInt(raw,10); if(!Number.isFinite(idx)) idx = -1;
  idx = (idx + 1) % max;
  localStorage.setItem(STORAGE_KEY, String(idx));
  return idx;
}
</script>

  <script>
  (function () {
    const params = new URLSearchParams(location.search);
    const next = params.get('next') || 'Dashboard-Refresh.html';

    // call this after your 7s animation OR on "Skip" click
    window.PUSplashGo = function () {
      // fade out if you want, then:
      window.location.replace(next);
    };

    // Auto-advance after 7s (or whatever you want)
    setTimeout(() => window.PUSplashGo(), 7000);
  })();
</script>

</body>
</html>
